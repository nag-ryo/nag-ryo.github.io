---
title: "ng-deepの指定時は追加のclassも同時指定"
date: "2025-01-23"
description: ""
category: "angular"
---


- Angularには各コンポーネントごとにcssファイルが使えて、そこでの定義はコンポーネントの外に影響しないようになっている。
	- しかし、Component外から持ってきて使用するマテリアルなどのスタイルを調整したい時がある。
	- `::ng-deep`を指定すると、定義したスタイルをComponentの外へ波及させることができる。これによりマテリアルのスタイルを変更することができる。
	- しかし、他のComponentで使用しているマテリアルにも影響が出てしまう。
		- 今回は過去に設定した`::ng-deep`が原因だった。
## どうしたのか
- モーダルで使用している`cdk-overlay-pane`のクラスに対して、モーダルのwidthを`::ng-deep`を使って指定していた。
	- `cdk-overlay-pane`クラスはマテリアルで共通で使われるので不具合が発生していた。
- クラスの指定の時に、さらにそのComponent内だけで使われるクラス名を同時に指定すれば、スタイルの影響はそのComponent内だけになる。

Componentの`ngOnInit()`で、ダイアログにクラスを付与する。

```ts
ngOnInit() {
	// モーダルのスタイルをng-deepで上書きしたいため、影響が出ないように追加のクラスを付与
	this.dialogRef.addPanelClass('test-modal');
}
```

CSSで追加のクラスも指定する。

```css
::ng-deep .cdk-overlay-pane.test-modal {
	width: 100%;
	@include sp {
		height: 100%;
	}
}
```

## 考察
- マテリアルに対してスタイルを適用したいことは必ずあるので、ソリューションも必ず実装されているはず。
	- 自分が困るということは、ほぼ必ず以前に困っている人がいるはず。
- ドキュメントを事前に読み込んだり、やりたいことで調べてみると解決策が見つかりやすいと思われる。